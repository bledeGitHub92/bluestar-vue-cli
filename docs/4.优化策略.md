## 代码分隔

### 异步组件

各路由首屏不需渲染的组件使用[异步组件](https://ssr.vuejs.org/zh/routing.html)

```js
const Foo = import('./Foo.vue');
```

### 异步路由组件

异步加载路由组件。

```js
new Router({
  routes: [{
    path: '/', component: () => import('./components/Home.vue'),
    path: '/item/:id', component: () => import('./components/Item.vue'),
    ...
  }]
})
```

## Store 代码拆分

[动态注册 Store module](https://ssr.vuejs.org/zh/data.html)

```js
// store/modules/foo.js
export default {
  namespaced: true,
  // 重要信息：state 必须是一个函数，
  // 因此可以创建多个实例化该模块
  state: () => ({
    count: 0
  }),
  actions: {
    inc: ({ commit }) => commit('inc')
  },
  mutations: {
    inc: state => state.count++
  }
}
```

```html
<!-- 在路由组件内 -->
<script>
// 在这里导入模块，而不是在 `store/index.js`
import fooStoreModule from '../store/modules/foo'
export default {
  asyncData ({ store }) {
    store.registerModule('foo', fooStoreModule)
    return store.dispatch('foo/inc')
  },
  // 重要信息：当多次访问路由时，
  // 避免在客户端重复注册模块。
  destroyed () {
    this.$store.unregisterModule('foo')
  },
  computed: {
    fooCount () {
      return this.$store.state.foo.count
    }
  }
}
</script>
```

## 缓存

to do